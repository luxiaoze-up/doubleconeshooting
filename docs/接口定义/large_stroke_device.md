# 大行程接口定义

Source: d:\00.My_workspace\DoubleConeShooting\docs\接口定义\大行程接口定义.xlsx

## Sheet: 01.Property

| Unnamed: 0   | Unnamed: 1                                       | Unnamed: 2   | Unnamed: 3                    | Unnamed: 4      | Unnamed: 5                                                    | Unnamed: 6                                                                   |
|:-------------|:-------------------------------------------------|:-------------|:------------------------------|:----------------|:--------------------------------------------------------------|:-----------------------------------------------------------------------------|
|              | 服务名称：large_stroke_server/large_stroke （真空系统/大行程） |              |                               |                 |                                                               |                                                                              |
|              | 序号                                               | 接口名称         | 设计名称                          | 数据类型            | 默认值                                                           | 接口说明                                                                         |
|              | 1                                                | 束组编码         | bundleNo                      | String          | 0000                                                          | 束组编码对照《重大装置光学工程设计规范手册》（GYB 63-2019）                                          |
|              | 2                                                | 子束编码         | laserNo                       | String          | 0000                                                          | 子束编码对应《重大装置光学工程设计规范手册》（GYB 63-2019）中的子束代码Z1～Z4、Y1～Y4，如果不属于子束则省略子束编码（即仅为束组编码） |
|              | 3                                                | 系统/分系统编码     | systemNo                      | String          | 0001                                                          | 系统软件编码[分系统软件编码]，编码参见《重大装置电气工程设计规范手册》（GYB 65A-2020）的表1                        |
|              | 4                                                | 关联设备名        | subDevList                    | String          |                                                               | Json类型，需要访问的其他服务名列表，如["MCLA_A01Y3/Moter/01","MCLA_A01Z2/Moter/02"]           |
|              | 5                                                | 支持型号列表       | modelList                     | Array of String |                                                               | 设备型号列表                                                                       |
|              | 6                                                | 当前型号         | currentModel                  | String          | 0000                                                          | 配置错误则state显示UNKNOWN，status显示"error，model supported: xxx"                     |
|              | 7                                                | 错误编码信息       | errorDict                     | String          | {"-1":"error","3000":"3000 error"}                            | JSON对象格式字符串，例如：                                                              |
|              |                                                  |              |                               |                 |                                                               | {"-1":"xxx error","3000":"xxx error"}                                        |
|              | 8                                                | 设备名称         | deviceName                    | String          | 送靶大行程                                                         | 送靶大行程                                                                        |
|              | 9                                                | 设备编号         | deviceID                      | String          | DB01                                                          |                                                                              |
|              | 10                                               | 设备安装位置描述     | devicePosition                | String          | Shanghai                                                      |                                                                              |
|              | 11                                               | 设备出厂日期       | deviceProductDate             | String          | “2026/02/28”                                                  | yyyy-mm-dd                                                                   |
|              | 12                                               | 设备上线日期       | deviceInstallDate             | String          | “2025/12/31”                                                  | yyyy-mm-dd                                                                   |
|              | 13                                               | 运动范围         | moveRange                     | DevShort        | 9000                                                          | 运动范围：9000mm                                                                  |
|              | 14                                               | 限位开关数量       | limitNumber                   | DevShort        | 3                                                             | 限位开关数量：原点、表征位置、打靶位置                                                          |
|              | 15                                               | 运动控制器服务名     | motionControllerName          | String          | sys/motion/1                                                  | 雷赛 型号：SMC608-BAS                                                             |
|              | 16                                               | 运动控制器连接信息    | MotionControllerConnectString | String          | {"Name":"MotionController1",“ip”:”192.168.1.11”,”axisId”:"0”} | 连接硬件设备所需的信息                                                                  |
|              |                                                  |              |                               |                 |                                                               | JSON对象格式字符串，例如{“ip”:”127.0.0.1”,”port”:"4001”}                               |
|              | 17                                               | 绝对编码器服务名     | encoderName                   | String          | sys/encoder/1                                                 | 哈尔滨明快机电 型号：AELAN10                                                           |
|              | 18                                               | 绝对编码器连接信息    | EncoderConnectString          | String          | {"Name":"Encoder",“ip”:”192.168.1.20”,”port”:"20200”}         | 连接硬件设备所需的信息                                                                  |
|              |                                                  |              |                               |                 |                                                               | JSON对象格式字符串，例如{“ip”:”127.0.0.1”,”port”:"4001”}                               |

## Sheet: 02.Attribute

| Unnamed: 0   | Unnamed: 1                                       | Unnamed: 2   | Unnamed: 3         | Unnamed: 4   | Unnamed: 5   | Unnamed: 6                                                                                                            | Unnamed: 7            | Unnamed: 8       |
|:-------------|:-------------------------------------------------|:-------------|:-------------------|:-------------|:-------------|:----------------------------------------------------------------------------------------------------------------------|:----------------------|:-----------------|
|              | 服务名称：large_stroke_server/large_stroke （真空系统/大行程） |              |                    |              |              |                                                                                                                       |                       |                  |
|              | 序号                                               | 接口名称         | 设计名称               | 数据类型         | 读写（R/W）      | 接口说明                                                                                                                  | 数据策略                  | 备注               |
|              | 1                                                | 设备状态         | State              | DevState     | R            | 设备状态：程序启动时初始状态INIT、连接状态ON、断开状态OFF、上电状态OPEN、运动状态RUNNING、下电状态CLOSE、未知状态UNKOWN、故障状态FAULT、正常待命STANDBY、报警ALARM、失能状态DISABLE |                       |                  |
|              | 3                                                | 自检结果         | selfCheckResult    | DevLong      | R            | 小于0代表未启动过自检，0代表自检正常，大于0代表自检异常,其中1代表电机自检异常，2代表相机自检异常，3代表光源自检异常，4代表其他异常                                                 |                       |                  |
|              | 4                                                | 位置单位         | positionUnit       | DevString    | RW           | 运动距离的单位，取值范围为step、mm、um、rad、urad、mrad其一，默认为step                                                                       |                       |                  |
|              | 5                                                | 组合属性         | groupAttributeJson | DevString    | R            | 设备attribute的名和值的集合，JSON对象。                                                                                            |                       |                  |
|              |                                                  |              |                    |              |              | 所有设备服务均提供该接口，用于一次获取多个attribute的值（主要考虑聚合Scalar类型Attribute，特别是常用的、关键的attribute）                                         |                       |                  |
|              |                                                  |              |                    |              |              | {                                                                                                                     |                       |                  |
|              |                                                  |              |                    |              |              |   MotorPos: value[4],motorstate:value[4]                                                                              |                       |                  |
|              |                                                  |              |                    |              |              |   lightluminance: value[4],lightstate：value[4]   ......                                                               |                       |                  |
|              |                                                  |              |                    |              |              | }                                                                                                                     |                       |                  |
|              | 6                                                | 插板阀状态        | hostPlugState      | DevString    | R            | OPENING：正在打开，CLOSING：正在关闭，OPENED：已打开。CLOSED：已关闭，UNKNOWN：未知。                                                           | 状态改变时刷新               |                  |
|              | 7                                                | 绝对编码器位置      | largeRangePos      | DevDouble    | R            | 绝对式编码器采集卡反馈的电机位置数值                                                                                                    |                       |                  |
|              | 8                                                | 指令位置         | direPos            | DevDouble    | R            | 控制器反馈的大行程电机位置数值                                                                                                       |                       |                  |
|              | 9                                                | 日志           | LinearLogs         | DevString    | R            | JSON对象 格式字符串：                                                                                                         | 执行新指令、指令完成、出现报警、出错时记录 |                  |
|              |                                                  |              |                    |              |              | { "time"："event"....}                                                                                                 |                       |                  |
|              | 10                                               | 报警状态         | alarmState         | DevString    | R            | DataTime：时间戳，Description：描述，Origin：源头，Reason：原因，Severity：等级                                                           | 定时检测，每隔30ms检测一次       |                  |
|              | 11                                               | 轴参数          | axisParameter      | DevString    | R            | 反馈当前服务使用的轴极其对应的运动参数/结构参数，                                                                                             | 参数发生改变时刷新             | {                |
|              |                                                  |              |                    |              |              | 返回json格式字符串{                                                                                                          |                       |   "X号轴":{        |
|              |                                                  |              |                    |              |              |   "AxisX":{                                                                                                           |                       |   "步距角": "XXX",  |
|              |                                                  |              |                    |              |              |   "StepAngle": "XXX",                                                                                                 |                       |   "传动比": "XXX",  |
|              |                                                  |              |                    |              |              |   "GearRatio": "XXX",                                                                                                 |                       |   "细分数": "XXX"   |
|              |                                                  |              |                    |              |              |   "Subdivision": "XXX"                                                                                                |                       |   "起始速度": "XXX", |
|              |                                                  |              |                    |              |              |   "StartSpeed": "XXX",                                                                                                |                       |   "最大速度": "XXX", |
|              |                                                  |              |                    |              |              |    "MaxSpeed": "XXX",                                                                                                 |                       |   "加速时间": "XXX", |
|              |                                                  |              |                    |              |              |    "AccelerationTime": "XXX",                                                                                         |                       |   "减速时间": "XXX", |
|              |                                                  |              |                    |              |              |    "DecelerationTime": "XXX",                                                                                         |                       |   "停止速度": "XXX"  |
|              |                                                  |              |                    |              |              |    "StopSpeed": "XXX"，                                                                                                |                       |   "分辨率"："XXX"    |
|              |                                                  |              |                    |              |              |   "ChannelNumber": "XXX"                                                                                              |                       | }，"X号轴"：{        |
|              |                                                  |              |                    |              |              |                                                                                                                       |                       |    .....         |
|              |                                                  |              |                    |              |              | }，"AxisX":{                                                                                                           |                       | }                |
|              |                                                  |              |                    |              |              |     ....                                                                                                              |                       | }                |
|              |                                                  |              |                    |              |              | }                                                                                                                     |                       |                  |
|              |                                                  |              |                    |              |              | }                                                                                                                     |                       |                  |
|              | 12                                               | 大行程限位及原点状态   | LargeLimOrgState   | DevShort     | R            | 1：正限位，-1：负限位，0：原点，2：不在限位位置                                                                                            | 定时检测，每隔1000ms检测一次     |                  |
|              | 13                                               | 大行程状态        | LargeRangeState    | DevBoolean   | R            | true：忙碌；false：空闲                                                                                                      | 定时检测，每隔1000ms检测一次     |                  |
|              | 14                                               | 执行任务返回值      | resultValue        | DevShort     | R            | 当前任务的返回值，0：成功 1：失败                                                                                                    |                       |                  |

## Sheet: 03.Command

| Unnamed: 0   | Unnamed: 1                                       | Unnamed: 2   | Unnamed: 3    | Unnamed: 4        | Unnamed: 5   | Unnamed: 6                                                                |
|:-------------|:-------------------------------------------------|:-------------|:--------------|:------------------|:-------------|:--------------------------------------------------------------------------|
|              | 服务名称：large_stroke_server/large_stroke （真空系统/大行程） |              |               |                   |              |                                                                           |
|              | 序号                                               | 接口名称         | 设计名称          | 输入数据类型            | 输出数据类型       | 接口说明                                                                      |
|              | 1                                                | 预约锁定         | devLock       | DevVoid           | DevVoid      | 预约锁定，本接口由“软件集成开发平台组件”提供统一实现（C++）；                                         |
|              |                                                  |              |               |                   |              | 输入数据为JSON格式字符串，包括用户名、角色名、角色等级等信息；                                         |
|              |                                                  |              |               |                   |              | 预约锁定失败抛出异常                                                                |
|              | 2                                                | 解除锁定         | devUnlock     | DevBoolean        | DevVoid      | 解除锁定，本接口由“软件集成开发平台组件”提供统一实现（C++）；                                         |
|              |                                                  |              |               |                   |              | 输入数据为：true为所有客户端解锁，false为当前客户端解锁；                                         |
|              |                                                  |              |               |                   |              | 解除锁定失败抛出异常                                                                |
|              | 3                                                | 锁定确认         | devLockVerify | DevVoid           | DevVoid      | 锁定确认，本接口由“软件集成开发平台组件”提供统一实现（C++）；                                         |
|              |                                                  |              |               |                   |              | 锁定确认失败抛出异常                                                                |
|              | 4                                                | 锁定查询         | devLockQuery  | DevVoid           | DevString    | 锁定查询，本接口由“软件集成开发平台组件”提供统一实现（C++）；                                         |
|              |                                                  |              |               |                   |              | 返回当前预约锁定的所有客户端信息，JSON格式字符串；                                               |
|              |                                                  |              |               |                   |              | 锁定查询失败抛出异常                                                                |
|              | 5                                                | 用户配置         | devUserConfig | DevVoid           | DevVoid      | 预约锁定，本接口由“软件集成开发平台组件”提供统一实现（C++）；                                         |
|              |                                                  |              |               |                   |              | 输入数据为JSON格式字符串，包括用户名、角色名、角色等级等信息；                                         |
|              |                                                  |              |               |                   |              | 用户配置失败抛出异常                                                                |
|              | 6                                                | 自检           | selfCheck     | DevVoid           | DevVoid      | 自检，设备根据自身情况处理，尽可能能反映设备状况；查询结果保存在Attribute的selfCheckState和selfCheckStatus中 |
|              | 7                                                | 初始化          | init          | DevVoid           | DevVoid      | 系统初始化                                                                     |
|              | 8                                                | 轴运动参数设置      | moveAxisSet   | DevVarDoubleArray | DevVoid      | 输入值：[0]-[4]分别设置电机的起始速度、最大速度、加速时间、减速时间、停止速度                                |
|              | 9                                                | 轴结构参数设置      | structAxisSet | DevVarDoubleArray | DevVoid      | 输入值：[0]:步角距，[1]:传动比，[2]:细分                                                |
|              | 10                                               | 相对运动         | moveRelative  | DevDouble         | DevVoid      | 输入值：相对运动的位置                                                               |
|              | 11                                               | 绝对运动         | moveAbsolute  | DevDouble         | DevVoid      | 输入值：绝对运动的位置                                                               |
|              | 12                                               | 停止           | stop          | DevVoid           | DevVoid      | 停止运动                                                                      |
|              | 13                                               | 复位           | reset         | DevVoid           | DevVoid      | 复位                                                                        |
|              | 14                                               | 读取绝对编码器位置值   | readEncoder   | DevVoid           | DevDouble    | 返回值:绝对编码器反馈位置。                                                            |
|              | 15                                               | 自动位置控制       | largeMoveAuto | DevVoid           | DevVoid      | 大行程自动运动到特定位置。                                                             |
|              | 16                                               | 插板阀开关        | openValue     | DevShort          | DevVoid      | 输入值:0/1,开/关。                                                              |
|              | 17                                               | 插板阀开关信号读取    | plugInRead    | DevVoid           | DevBoolean   | 返回值：开到位/关到位。                                                              |
|              | 18                                               | 原点状态读取       | readOrg       | DevVoid           | DevBoolean   | 返回值：true/false，在原点/不在原点。                                                  |
|              | 19                                               | 限位状态读取       | readEL        | DevVoid           | DevShort     | 返回值：0-无；1-EL+；2-EL-。                                                      |
|              | 20                                               | 大行程允许插板阀动作   | runAction     | DevShort          | DevVoid      | 通知PLC端可以开或关插板阀。输入值：0允许动作;1不允许动作                                           |
|              | 22                                               | 参数读取         | readtAxis     | DevVoid           | DevString    | 读取轴的运动参数、结构参数、以及对应编码器分辨率，返回json格式字符串                                      |
|              | 23                                               | 参数导出         | exportAxis    | DevVoid           | DevVoid      | 导出对应轴的运动参数、结构参数、以及对应编码器分辨率为本地文件                                           |
|              | 备注：接口调用出现问题时，抛出异常                                |              |               |                   |              |                                                                           |

## Sheet: 04.状态机

| Unnamed: 0   | Unnamed: 1                                       | Unnamed: 2   | Unnamed: 3    | Unnamed: 4     | Unnamed: 5   | Unnamed: 6   | Unnamed: 7   |
|:-------------|:-------------------------------------------------|:-------------|:--------------|:---------------|:-------------|:-------------|:-------------|
|              | 服务名称：large_stroke_server/large_stroke （真空系统/大行程） |              |               |                |              |              |              |
|              | 序号                                               | 接口名称         | 设计名称          | 设备不在线(UNKNOWN) | 在线不工作(OFF)   | 在线工作(ON)     | 故障(FAULT)    |
|              | 1                                                | 预约锁定         | devLock       | √              | √            |              | √            |
|              | 2                                                | 解除锁定         | devUnlock     | √              | √            |              | √            |
|              | 3                                                | 锁定确认         | devLockVerify | √              | √            | √            | √            |
|              | 4                                                | 锁定查询         | devLockQuery  | √              | √            | √            | √            |
|              | 5                                                | 用户配置         | devUserConfig | √              | √            | √            | √            |
|              | 6                                                | 自检           | selfCheck     | √              | √            |              | √            |
|              | 7                                                | 初始化          | init          | √              | √            |              | √            |
|              | 8                                                | 轴运动参数设置      | moveAxisSet   |                | √            | √            | √            |
|              | 9                                                | 轴结构参数设置      | structAxisSet |                | √            | √            | √            |
|              | 10                                               | 相对运动         | moveRelative  |                |              | √            |              |
|              | 11                                               | 绝对运动         | moveAbsolute  |                |              | √            |              |
|              | 12                                               | 停止           | stop          |                | √            | √            | √            |
|              | 13                                               | 复位           | reset         |                | √            | √            | √            |
|              | 14                                               | 读取绝对编码器位置值   | readEncoder   |                | √            | √            | √            |
|              | 15                                               | 自动位置控制       | largeMoveAuto |                |              | √            |              |
|              | 16                                               | 插板阀开关        | openValue     |                |              | √            |              |
|              | 17                                               | 插板阀开关信号读取    | plugInRead    |                | √            | √            | √            |
|              | 18                                               | 原点状态读取       | readOrg       |                | √            | √            | √            |
|              | 19                                               | 限位状态读取       | readEL        |                | √            | √            | √            |
|              | 20                                               | 大行程允许插板阀动作   | runAction     |                |              | √            |              |
|              | 21                                               | 日志导出         | exportLogs    |                | √            | √            | √            |
|              | 22                                               | 参数读取         | readtAxis     |                | √            | √            | √            |
|              | 23                                               | 参数导出         | exportAxis    |                | √            | √            | √            |
|              | 24                                               | 模拟运行开关       | simSwitch     |                | √            | √            | √            |

